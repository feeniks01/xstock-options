# OptionsFi - Cursor Rules for Team

## Project Status

✅ **Ready for Hackathon Demo**
- 5 vaults live on Devnet
- $17K+ TVL in NVDAx vault
- Real Pyth oracle prices
- Working deposit/withdraw flow

## Quick Demo Setup

When a team member asks to set up or test the demo:

1. **First, check if they have a wallet:**
   - Ask them to run: `ls my-wallet.json ~/.config/solana/id.json 2>/dev/null`
   - If no wallet exists, help them create one

2. **Creating a wallet from Phantom:**
   ```bash
   npx ts-node scripts/convert-phantom-key.ts THEIR_PHANTOM_KEY
   ```

3. **Creating a fresh CLI wallet:**
   ```bash
   solana-keygen new -o my-wallet.json --no-bip39-passphrase
   solana airdrop 2 $(solana-keygen pubkey my-wallet.json) --url devnet
   ```

4. **Starting the demo:**
   ```bash
   pnpm install
   cd app && pnpm install && pnpm dev
   ```
   Then open http://localhost:3000/v2

5. **Key pages to show:**
   - `/v2` - Dashboard with 5 vaults, TVL, APY
   - `/v2/earn/nvdax` - NVDAx vault with live Pyth prices & payoff chart
   - `/v2/oracle` - Real-time price feeds for all 5 assets

## Live Vaults on Devnet

| Vault | Asset ID | APY | Status |
|-------|----------|-----|--------|
| NVDAx | NVDAx | 12.4% | ✅ Main demo vault |
| TSLAx | TSLAx | 18.6% | ✅ Live |
| AAPLx | AAPLx | 8.2% | ✅ Live |
| SPYx | SPYx | 6.5% | ✅ Live |
| METAx | METAx | 15.2% | ✅ Live |

## Key Files to Know

- `app/lib/vault-sdk.ts` - Vault configurations and program IDs
- `app/hooks/useVault.ts` - React hook for vault interactions
- `app/app/v2/earn/[ticker]/page.tsx` - Individual vault page
- `app/app/v2/oracle/page.tsx` - Oracle price feeds page
- `scripts/demo-epoch.ts` - Advance epoch (simulate yield)
- `scripts/setup-demo-vault.ts` - Create new vault
- `scripts/convert-phantom-key.ts` - Convert Phantom key to JSON

## Important Notes

- Use `pnpm` not `npm` or `yarn`
- Always use devnet for testing
- Wallet keypairs are JSON arrays of numbers, not base58 strings
- Phantom must be set to Devnet (Settings → Developer Settings → Network)
- RFQ shows "Offline" - this is expected, explain as "institutional integration"

## Epoch Advancement (Vault Authority Only)

⚠️ **Each vault has an authority** - only that wallet can advance epochs.

**NVDAx vault authority:** `5cyhTaQ5A7gxwF5zmpn4zJHsyiLBQV9ffPvtNPYNiLpX` (not Julian's wallet)

**Options:**
1. **Demo without epoch advance** - Show existing TVL, explain keeper runs automatically
2. **Create your own vault** - `KEYPAIR=./my-wallet.json npx ts-node scripts/setup-demo-vault.ts`
3. **Use original deployer key** - If you have access to the NVDAx authority wallet

```bash
# If you created your own vault:
KEYPAIR=./my-wallet.json npx ts-node scripts/demo-epoch.ts --asset=YOUR_ASSET_ID --premium=1.5
```

## When Things Go Wrong

### "No wallet found"
Create one: `solana-keygen new -o my-wallet.json`

### "Insufficient SOL"
```bash
solana airdrop 2 --url devnet
```
Or use https://faucet.solana.com/

### "Blockhash not found"
Just retry - devnet can be flaky

### "Vault not found"
Use one of the existing vaults (NVDAx, TSLAx, etc.) or create your own with setup-demo-vault.ts

### Oracle prices showing "—"
Wait 5-10 seconds for Pyth to connect. Auto-refreshes every 10s.

### Frontend not loading
1. Make sure you ran `pnpm install` in both root AND app directories
2. Check Phantom is on devnet
3. Hard refresh (Cmd+Shift+R)

## Demo Talking Points

1. **"Earn 12-18% APY on synthetic stocks through automated covered calls"**
2. **"Real Pyth oracle prices - see NVDA at $176 with 10% OTM strike at $194"**
3. **"ERC-4626 style vault shares - deposit NVDAx, receive vNVDAx"**
4. **"Institutional RFQ infrastructure for competitive market maker pricing"**
5. **"Built on Solana - fast, cheap, 24/7 trading"**
